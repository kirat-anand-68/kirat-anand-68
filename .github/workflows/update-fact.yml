name: Update Data Science Fact Daily

on:
  schedule:
    - cron: '30 18 * * *'   # Daily at 12:00 AM IST
  workflow_dispatch:

jobs:
  update-fact:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Pick and insert random fact
        run: |
          # Safety check for facts.txt
          if [ ! -f facts.txt ] || [ ! -s facts.txt ]; then
            echo "ERROR: facts.txt missing or empty! Add facts first."
            exit 1
          fi
          
          # Pick random fact
          FACT=$(shuf -n 1 facts.txt | sed 's/^"//' | sed 's/"$//')  # Strip quotes
          echo "ðŸ¤– Selected fact: $FACT"
          
          if [ -z "$FACT" ]; then
            echo "ERROR: No fact picked!"
            exit 1
          fi
          
          # Simple replacement: Swap the entire block
          sed -i "/<!-- REPLACE_ME_TODAYS_FACT -->/,/<!-- END_REPLACE_ME -->/c\<!-- REPLACE_ME_TODAYS_FACT -->\n<p align=\"center\"><b>Today's Fact:</b> $FACT</p>\n<!-- END_REPLACE_ME -->" README.md
          
          # Update badge to "Live!"
          sed -i 's/Data_Science_Fact_Live!-00ff00/Data Science Fact Updated!-green/' README.md

      - name: Commit if changed
        uses: EndBug/add-and-commit@v9
        with:
          message: "ðŸ¤– Updated daily DS fact: $FACT"
          add: README.md

name: Update Data Science Fact Daily

on:
  schedule:
    - cron: '30 18 * * *'  # Runs daily at 12:00 AM IST (India time)
  workflow_dispatch:

jobs:
  update-fact:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Update daily fact
        run: |
          FACT=$(shuf -n 1 facts.txt)
          ESCAPED_FACT="${FACT//&/\\&}"
          
          # Replace the line between the placeholders
          sed -i "/<!-- DAILY_FACT_PLACEHOLDER_DO_NOT_DELETE -->/,/<!-- DAILY_FACT_PLACEHOLDER_DO_NOT_DELETE -->/c\<!-- DAILY_FACT_PLACEHOLDER_DO_NOT_DELETE -->\n<p align=\"center\"><b>Today's Fact:</b> $ESCAPED_FACT</p>\n<!-- DAILY_FACT_PLACEHOLDER_DO_NOT_DELETE -->" README.md
          
          # Also update badge to show it's live
          sed -i 's/Dynamic_Fact-Loading...-blue/Data Science Fact of the Day-00ff00/' README.md

      - name: Commit & push if changed
        run: |
          git config user.name "Daily Fact Bot"
          git config user.email "bot@kirat.dev"
          git add README.md
          git commit -m "Updated daily data science fact" || exit 0
          git push
